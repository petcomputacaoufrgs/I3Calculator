		var IE=false;
		var dom=document.getElementById?1:0;
		if ( navigator.appName=="Microsoft Internet Explorer" ) IE=true; 
		if (IE) classe='class';
		else classe='class';
		
		var lnks = new Array();
		var iGlobal = 0;
		var tamlnk = 0;

		var textF='FAVORITOS';
		var textC='CATÁLOGO DE SERVIÇOS';
		
		var LetrasD = new String("ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890ÁÀÂÃÉÈÊÍÌÓÒÔÕÚÙÜÇ- ");
		var LetrasT = new String("ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890AAAAEEEIIOOOOUUUC- ");
		
		
		function focos(thiss){
			setTimeout(function(){thiss.focus();},1);
		} 
		
		function trim(stringToTrim) {
			return stringToTrim.replace(/^\s+|\s+$/g,"");
		}

		function teclasproibidas(e) {
			var keynum;
			if (window.event) //IE
				keynum=window.event.keyCode;
			else {
				if(e.keyCode) {// netscape , opera ,firefox
					keynum=e.which;
				}
			}
			if(keynum==13) 	return false;
			else return true;
		}		
		
		function camposlnk(codigo,lnk,objetivo,consulta) {
			this.codigo   = codigo;
			this.lnk      = lnk;
			this.objetivo = objetivo;
			this.consulta = consulta;
		}
		
		function MenuBN(objeto) {
			aux=document.getElementById(objeto);
			if ( aux.style.display != 'block' ) {
			     aux.style.display='block'; 
			}
			else {	aux.style.display='none'; }
		}	

		function removerFilhos(param) {
			for(var i=0,elem;elem = param.childNodes[i];i++) {
				elem.parentNode.removeChild(elem);
			}
		}
		function addEvento(param){
			var y=param.id;
		    var aux=y.substring(1);
			var obj=param;   // É O PRÓPRIO OBJETO
			if (IE) obj.attachEvent('onclick', function() { MenuBN(aux); } );  
			else	obj.addEventListener('click',function() { MenuBN(aux); }, true); 
	    }

		function MontaCatalogoServicos(objetoXML) {
			//alert(objetoXML.responseText);
			var dataArray   = objetoXML.getElementsByTagName("row"); 
			if	( dataArray.length > 0 ) { 
				for	(var i=0; i<dataArray.length; i++) {
					var item = dataArray[i];
					var CODIGO		=  item.getElementsByTagName("codigo")[0].firstChild.nodeValue;
					var CODMENU		=  item.getElementsByTagName("codmenu")[0].firstChild.nodeValue;
					var MENU   		=  item.getElementsByTagName("menu")[0].firstChild.nodeValue;
					var CODSUBMENU 	=  item.getElementsByTagName("codsubmenu")[0].firstChild.nodeValue;
					var SUBMENU   	=  item.getElementsByTagName("submenu")[0].firstChild.nodeValue;
					var CODLINK   	=  item.getElementsByTagName("codlink")[0].firstChild.nodeValue;
					var LINK   		=  item.getElementsByTagName("link")[0].firstChild.nodeValue;
					var aux=LINK.substr(0,7);
                    if(aux!="http://" && aux!="https:/" && aux!="javascr")
                        LINK="/" + LINK;
                    else if(aux=="javascr")
                    {   
                        aux=LINK.substr(24,4);
                        if(aux!="http")
                            LINK=LINK.substr(0,24) + "/" + LINK.substr(24);
                    }
                    var NOME   		=  item.getElementsByTagName("nome")[0].firstChild.nodeValue;
					var OBJETIVO	=  item.getElementsByTagName("objetivo")[0].firstChild.nodeValue;
					var CONSULTA	=  item.getElementsByTagName("consulta")[0].firstChild.nodeValue;
					
					//
					// 	A PESQUISA ENVOLVE A , (VÍRGULA) TAMBÉM...
					//
					if  ( Codigos.indexOf(","+CODIGO+",") < 0 ) continue;
					
					if  ( Favoritos.indexOf(","+CODIGO+",") > -1 ) {
						var a = document.createElement('div');
						PrincipalF.appendChild(a);
						a.setAttribute(classe, "Tipo3");
						if (LINK.substring(0,11) == 'javascript:')
							a.innerHTML = "<a style='font-size: 3.5mm;' id='a"+CODIGO+"' href='#' onClick='"+LINK+"'>"+OBJETIVO+"</a>&nbsp;<a href='#' onClick='MudaFavoritos(0,"+CODIGO+");'><img style='border: none' src='/admdados/entradaintranet/public/RemoverFavoritos.gif'></a>";
						else {
							if (CODIGO=='10004') {
								a.innerHTML = "<a style='font-size: 3.5mm;' id='a"+CODIGO+"' href='"+LINK+CPF+"'>"+OBJETIVO+"</a>&nbsp;<a href='#' onClick='MudaFavoritos(0,"+CODIGO+");'><img style='border: none' src='/admdados/entradaintranet/public/RemoverFavoritos.gif'></a>";
							}
							else {
								a.innerHTML = "<a style='font-size: 3.5mm;' id='a"+CODIGO+"' href='"+LINK+"'>"+OBJETIVO+"</a>&nbsp;<a href='#' onClick='MudaFavoritos(0,"+CODIGO+");'><img style='border: none' src='/admdados/entradaintranet/public/RemoverFavoritos.gif'></a>";
							}		
						}					
					}
					
    				lnks[tamlnk] = new camposlnk(CODIGO,LINK,OBJETIVO,CONSULTA);
					tamlnk++;
					CodMenu=document.getElementById(CODMENU);
					if(CodMenu==null) {
						var MenuContainer = document.createElement("div");
						MenuContainer.setAttribute(classe, "Tipo1");
						PrincipalC.appendChild(MenuContainer);
							MenuClick = document.createElement("div");
							MenuClick.id = 'M'+CODMENU;
							MenuClick.innerHTML="<img src='/admdados/entradaintranet/public/pastadir.gif'>&nbsp;"+MENU;
							MenuClick.setAttribute(classe, "TipoMenu");
							MenuContainer.appendChild(MenuClick);
							
							var Menux = document.createElement("div");
							Menux.id = CODMENU;
							Menux.setAttribute(classe, "Tipo2");	
							MenuContainer.appendChild(Menux);
							
							addEvento(MenuClick);
							CodMenu=document.getElementById(CODMENU);		
						
					}
					if (  CODSUBMENU != CODMENU) {
						SubMenu=document.getElementById(CODSUBMENU);
						if(SubMenu==null) {
							var SubMenuContainer = document.createElement("div");
							SubMenuContainer.setAttribute(classe, "submenucontainer");	
							Menux.appendChild(SubMenuContainer);
								var SubMenuClick = document.createElement("div");
								SubMenuClick.innerHTML="<img src='/admdados/entradaintranet/public/pastadir.gif'>&nbsp;"+SUBMENU;
								SubMenuClick.setAttribute('style', 'color: #000044');	
								SubMenuClick.style.color='#000044';
								
								SubMenuClick.id = 'S'+CODSUBMENU;
								SubMenuContainer.appendChild(SubMenuClick);
								
								var SubMenuX = document.createElement("div");
								SubMenuX.id = CODSUBMENU;
								SubMenuX.setAttribute(classe, "Tipo2");	
								SubMenuContainer.appendChild(SubMenuX);
								
								addEvento(SubMenuClick);
								SubMenu=document.getElementById(CODSUBMENU);
								
						}
						var a = document.createElement('div');
						a.setAttribute(classe, "div2");
						SubMenu.appendChild(a);
						if (LINK.substring(0,11) == 'javascript:')
							a.innerHTML = "<a href='#' onClick='"+LINK+"'>"+NOME+"</a><BR>";
						else {
							if (CODIGO=='10004')
								a.innerHTML = "<a href='"+LINK+CPF+"'>"+NOME+"</a><BR>";
							else a.innerHTML = "<a href='"+LINK+"'>"+NOME+"</a><BR>";						

						}
					}
					else {
						var a = document.createElement('div');
						a.setAttribute(classe, "div2");
						CodMenu.appendChild(a);
						if (LINK.substring(0,11) == 'javascript:')
							a.innerHTML = "<a href='#' onClick='"+LINK+"'>"+NOME+"</a><BR>";
						else {
							if (CODIGO=='10004')
								a.innerHTML = "<a href='"+LINK+CPF+"'>"+NOME+"</a><BR>";
							else a.innerHTML = "<a href='"+LINK+"'>"+NOME+"</a><BR>";						

						}
					}
				}
				tamlnk=lnks.length;
			}
			else {	alert("XML voltou vazio"); }
		}
	
		function pesquisalnk(letras) {
			var meudiv = document.getElementById('meudiv');
			while (iGlobal > 0) {
				meudiv.removeChild(meudiv.lastChild);
				iGlobal--;
			}
			if (trim(letras)==''){
                            if(document.getElementById('meudiv').hasChildNodes())
                {
                    document.getElementById('meudiv').style.display='block';
                }
                else
                    {
                         document.getElementById('meudiv').style.display='none'; 
                    }
                
                return; }
		    var letrasaux=letras;
			var letrasUpperCase = new String(letras.toUpperCase());
			var achouLetra = -1;
			var novoString = '';
			
			for (l=0; l<letrasUpperCase.length; l++) {
				achouLetra=LetrasD.indexOf(letrasUpperCase.substring(l,l+1));
				if ( achouLetra > -1 ) novoString=novoString+LetrasT.substr(achouLetra,1);
				else {
					document.forms[0].pesquisaservicos.value=letrasaux.substring(0,l);
					            if(document.getElementById('meudiv').hasChildNodes())
                {
                    document.getElementById('meudiv').style.display='block';
                }
                else
                    {
                         document.getElementById('meudiv').style.display='none'; 
                    }
                    return;
				}
			} 
			eval("exp=/^("+novoString+"[ ]?)|([ ]"+novoString+"[ ]?)/");
			for(x=0; x<tamlnk; x++) {
				if(exp.test(lnks[x]['consulta'])){
				    var cod=lnks[x]['codigo'];
					var a = document.createElement('div');
					a.setAttribute(classe, "div2");
					meudiv.appendChild(a);	
					//a.setAttribute(classe, "TipoPesquisa");
					if (lnks[x]['lnk'].substring(0,11) == 'javascript:')
                        a.innerHTML = "<a id='a"+x+"' href='#' onClick='"+lnks[x]['lnk']+"'>"+lnks[x]['objetivo']+"</a>&nbsp;<a href='#' onClick='MudaFavoritos(1,"+cod+");'><img style='border: none' src='/admdados/entradaintranet/public/AdicionarFavoritos.gif'></a><BR>";
					else {
					    if (cod=='10004')
							a.innerHTML = "<a id='a"+x+"' href='"+lnks[x]['lnk']+CPF+"'>"+lnks[x]['objetivo']+"</a>&nbsp;<a href='#' onClick='MudaFavoritos(1,"+cod+");'><img style='border: none' src='/admdados/entradaintranet/public/AdicionarFavoritos.gif'></a><BR>";
						else
							a.innerHTML = "<a id='a"+x+"' href='"+lnks[x]['lnk']+"'>"+lnks[x]['objetivo']+"</a>&nbsp;<a href='#' onClick='MudaFavoritos(1,"+cod+");'><img style='border: none' src='/admdados/entradaintranet/public/AdicionarFavoritos.gif'></a><BR>";					  
					}
					iGlobal++;
				}
			} 
            if(document.getElementById('meudiv').hasChildNodes())
                {
                    document.getElementById('meudiv').style.display='block';
                }
                else
                    {
                         document.getElementById('meudiv').style.display='none'; 
                    }
		}

        
		function carrega() { document.forms[0].pesquisaservicos.value=''; }

		function MudaFavoritos(t,cod) {
			if ( t==0 ) {
				opcao='R';
				msg='RETIRAR este LINK dos FAVORITOS no próximo logon?';
			}
			else {
				msg='ADICIONAR este LINK aos FAVORITOS no próximo logon?';
				opcao='A';
			}
			var x=window.confirm(msg);
			if (x) {
				document.getElementById('favor').src='/PORTAL_AlteraFavoritos.php?tipo='+ opcao +'&codigo=' + cod;
			}
			else
				return true;
		}
		
		function movemenu(sel)	{
			//'F'   ->	70		FAVORITOS -> PrincipalF
			//'C'   -> 	67		 LOCALIZAR SERVIÇOS -> PrincipalC
			var primeiro=sel.innerHTML.substring(0,1);
			if (sel.id=='aba1') return false;
			else {
				document.getElementById('aba1').innerHTML='';
				document.getElementById('aba2').innerHTML='';
				switch (primeiro.charCodeAt(0)) {
					case 70:
						document.getElementById('aba1').innerHTML=textF;
						document.getElementById('aba2').innerHTML=textC;
						PrincipalF.style.visibility='visible';
						PrincipalC.style.visibility='hidden';
						break;
					case 67:
						document.getElementById('aba1').innerHTML=textC;
						document.getElementById('aba2').innerHTML=textF;
						PrincipalC.style.visibility='visible';
						PrincipalF.style.visibility='hidden';
						break;
					default:
						document.getElementById('aba1').innerHTML='ERRO';
						document.getElementById('aba2').innerHTML='ERRO';
				}
			}
			document.cabecalho.pesquisaservicos.focus();
		}
		
		function Ajax() {	//verifica se o browser tem suporte a ajax
			try { ajax = new ActiveXObject("Microsoft.XMLHTTP"); }
			catch(e) {	try { ajax = new ActiveXObject("Msxml2.XMLHTTP"); }
						catch(ex) {	try { ajax = new XMLHttpRequest(); }
									catch(exc) {
										alert("Esse browser não tem recursos para uso do Ajax");
										ajax  = null;
									}
								}
					}
			if ( ajax ) { 
				ajax.open("GET", "/PORTALXML/Portal_Menu_"+ArquivoPortalXML+".xml", true);
				ajax.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=iso-8859-1");
				ajax.setRequestHeader("Cache-Control", "no-store, no-cache, must-revalidate");   
				ajax.setRequestHeader("Pragma", "no-cache");
				ajax.onreadystatechange = function() {
					if	(ajax.readyState == 4  && ajax.status == 200) {	
						if	(ajax.responseXML) { 
							//alert(ajax.responseText);
							MontaCatalogoServicos(ajax.responseXML);
						}
						else { alert("ResponseXML está vazio."); }
					}
				}
				ajax.send('');
			}
		}